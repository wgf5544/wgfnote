### 数据备份与一致性

#### CAP理论

分布式系统（distributed system）正变得越来越重要，大型网站几乎都是分布式的。

分布式系统最大的难点，就是各个节点的状态如何同步。而CAP理论是这方面的基本定理，也是理解分布式系统的起点。

任何分布式系统在可用性、一致性、分区容错性方面，不能兼得，最多只能兼顾其中的两个，因此任何分布式系统的设计只是三者中的不同取舍而已。

以下是分布式系统三个指标：

* Consistency
* Availability
* Partition tolerance（分区容错）

#### Consistency

一致性，访问所有节点得到的数据应该是一样的。

这里的一致性是强一致性，也就是数据更新完，访问任何节点看到的数据完全一致。不同于弱一致性，最终一致性。

#### Availability

可用性，所有节点都保持高可用性。

注意，这里的高可用还包括不能出现延迟，比如如果节点B由于等待数据同步而阻塞请求，那么节点B就不满足高可用性。

也就是，任何没有发生故障的服务必须在有限的时间内返回合理的结果集。

####  Partition tolerance

分区容错，由于网络是不可靠的，所有节点之间可能出现无法通信的情况。而在节点不能通信时，要保证系统可以继续正常服务。

由于网络的不可靠性质，大多数开源的分布式系统都会实现P，也就是分区容错性，之后在C和A中做选择。

